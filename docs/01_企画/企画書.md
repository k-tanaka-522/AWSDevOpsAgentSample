# X-Ray Watch POC 企画書

## 1. プロジェクト概要

| 項目 | 内容 |
|------|------|
| プロジェクト名 | X-Ray Watch POC |
| プロジェクト種別 | 技術検証（POC） |
| 担当範囲 | インフラ領域 |
| 作成日 | 2025-12-10 |

---

## 2. ビジネス背景

### 2.1 現状
- オンプレミス環境でシステムを運用中
- 監視: Hinemos
- データ層: PostgreSQL (Pacemaker/pg-rex) + Elasticsearch
- ビジネスロジック: intra-mart datamanager
- 複数のマイクロサービスが稼働

### 2.2 課題・検討事項
- オンプレミスからAWSへの移行を検討中
- 移行前に、AWSで同等の監視・運用が実現可能か検証が必要

### 2.3 なぜ今POCが必要か
- 本格移行の前に、小規模なPOCで実現可能性を確認
- 特にX-Ray、CloudWatch、AWS DevOps Agentなど新しいサービスの評価が必要

---

## 3. プロジェクトの目的

AWS環境での監視・品質管理・AI活用の実現可能性を検証する。

### 3.1 検証対象
1. **X-Ray** - 分散トレーシングによるレスポンス追跡
2. **CloudWatch + SNS** - アラート監視とメール通知
3. **AWS DevOps Agent** - AIによる1次調査・品質管理

---

## 4. 成功基準（KPI）

| # | 成功基準 | 判定方法 |
|---|----------|----------|
| 1 | X-Rayで遅延の原因が特定できること | 意図的に遅いAPIを作成し、X-Rayで遅延箇所を可視化 |
| 2 | CloudWatchアラートがSNSで通知されること | アラート条件を設定し、メール通知を受信 |
| 3 | AWS DevOps Agentの品質検証 | GitHub連携でIssue自動起票の動作確認 |

---

## 5. POC構成

### 5.1 システム構成図（概念）

```
┌─────────────────────────────────────────────────────────────┐
│                         AWS Cloud                           │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐     │
│  │ API Gateway │───▶│  ECS        │───▶│    RDS      │     │
│  │ (Node.js)   │    │  (Python)   │    │ (PostgreSQL)│     │
│  └─────────────┘    └─────────────┘    └─────────────┘     │
│         │                  │                               │
│         ▼                  ▼                               │
│  ┌─────────────────────────────────────┐                   │
│  │           AWS X-Ray                 │                   │
│  │    (分散トレーシング・遅延分析)       │                   │
│  └─────────────────────────────────────┘                   │
│         │                                                  │
│         ▼                                                  │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐     │
│  │ CloudWatch  │───▶│    SNS      │───▶│  Email      │     │
│  │  (監視)     │    │  (通知)     │    │ (HTML形式)  │     │
│  └─────────────┘    └─────────────┘    └─────────────┘     │
│         │                                                  │
│         ▼                                                  │
│  ┌─────────────────────────────────────┐                   │
│  │      AWS DevOps Agent               │                   │
│  │  (AI調査・GitHub Issue連携)          │                   │
│  └─────────────────────────────────────┘                   │
└─────────────────────────────────────────────────────────────┘
```

### 5.2 技術スタック

| レイヤー | 技術 | 備考 |
|----------|------|------|
| フロント/API Gateway | Node.js | シンプルなエンドポイント |
| API | Python on ECS | サンプルCRUD + 意図的に遅いAPI |
| DB | RDS (PostgreSQL) | 最小構成 |
| 監視 | X-Ray, CloudWatch | 分散トレーシング、メトリクス |
| 通知 | SNS | HTMLメール |
| AI | AWS DevOps Agent | GitHub連携 |
| IaC | CloudFormation | POC後にTerraform化予定 |

### 5.3 アプリケーションについて
- **品質レベル**: サンプル程度（インフラ検証が目的）
- **特記事項**: X-Ray評価のため、意図的に遅いAPIを含める

---

## 6. 制約条件

### 6.1 予算
- **月額**: 約1,000円程度
- **対策**:
  - 検証時のみリソース起動
  - 検証終了後は即削除（スクラップ&ビルド）
  - IaCで構築・破棄を容易に

### 6.2 スケジュール
- **優先度**: なるはや
- **作業形態**: 趣味・空き時間ベース
- **期限**: 特になし

### 6.3 運用方針
- IaC（CloudFormation）でインフラを管理
- 検証終了後はリソースを削除
- コードはGitHub管理

---

## 7. 将来の検証項目（POC Phase 2以降）

以下はPOC Phase 1完了後に追加検証予定：

1. **監視とワークフロー**
   - Hinemosの複雑な監視条件をCloudWatch + Step Functionsで実現可能か

2. **メール通知**
   - SES/SNSでグラフィカルで柔軟なHTML形式メール送信

3. **データ層**
   - PostgreSQL + OpenSearch構成の実現可能性
   - intra-mart datamanagerとの連携調査

4. **マイクロサービス**
   - 既存AWSマイクロサービスとの連携

---

## 8. 次のステップ

1. **要件定義フェーズ**
   - 機能要件の詳細化（API仕様、検証シナリオ）
   - 非機能要件の数値目標設定
   - AWSサービス構成の詳細化

2. **設計フェーズ**
   - CloudFormationテンプレート設計
   - ネットワーク設計（VPC、サブネット）
   - コスト最適化設計

---

## 9. 承認

| 役割 | 承認者 | 日付 |
|------|--------|------|
| プロジェクトオーナー | | |

---

**作成者**: Claude (AI開発ファシリテーター)
**作成日**: 2025-12-10
